"use strict";(self.webpackChunkparfay=self.webpackChunkparfay||[]).push([[98],{6098:(Q,c,i)=>{i.r(c),i.d(c,{ChatModule:()=>J});var l=i(8583),r=i(4655),e=i(7716);let m=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-chat"]],decls:1,vars:0,template:function(n,a){1&n&&e._UZ(0,"router-outlet")},directives:[r.lC],styles:[""]}),t})();var u=i(8239),d=i(3514),v=i(6199),f=i(1436),g=i(8295),h=i(3166),T=i(6109),x=i(1552);const Z=["messageBoxElement"];function _(t,s){1&t&&e.GkF(0)}function C(t,s){1&t&&e.GkF(0)}function M(t,s){1&t&&e.GkF(0)}function y(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"div",6),e.YNc(2,_,1,0,"ng-container",7),e.YNc(3,C,1,0,"ng-container",7),e.YNc(4,M,1,0,"ng-container",7),e.qZA(),e.BQk()),2&t){e.oxw();const n=e.MAs(2),a=e.MAs(6),o=e.MAs(10);e.xp6(2),e.Q6J("ngTemplateOutlet",n),e.xp6(1),e.Q6J("ngTemplateOutlet",a),e.xp6(1),e.Q6J("ngTemplateOutlet",o)}}function A(t,s){if(1&t&&(e.TgZ(0,"div",8),e.TgZ(1,"div",9),e.TgZ(2,"div",10),e._UZ(3,"img",11),e.qZA(),e.TgZ(4,"div",12),e._uU(5),e.qZA(),e.qZA(),e.qZA()),2&t){const n=e.oxw();e.xp6(5),e.hij(" ",null==n.targetUser?null:n.targetUser.alias," ")}}function U(t,s){if(1&t&&(e.TgZ(0,"div",13),e.TgZ(1,"div",14),e.TgZ(2,"div",10),e._UZ(3,"img",11),e.qZA(),e.TgZ(4,"div",12),e._uU(5),e.qZA(),e.qZA(),e.qZA()),2&t){const n=e.oxw();e.xp6(5),e.hij(" ",null==n.targetUser?null:n.targetUser.alias," ")}}function O(t,s){1&t&&e.GkF(0)}const P=function(t){return{$implicit:t}};function w(t,s){if(1&t&&(e.TgZ(0,"div",20),e.YNc(1,O,1,0,"ng-container",21),e.qZA()),2&t){const n=s.$implicit;e.oxw(2);const a=e.MAs(8);e.xp6(1),e.Q6J("ngTemplateOutlet",a)("ngTemplateOutletContext",e.VKq(2,P,n))}}function q(t,s){if(1&t&&(e.TgZ(0,"div",15,16),e.TgZ(2,"div",17),e.TgZ(3,"div",18),e.YNc(4,w,2,4,"div",19),e.qZA(),e.qZA(),e.qZA()),2&t){const n=e.oxw();e.xp6(4),e.Q6J("ngForOf",n.displayedMessages)}}function B(t,s){if(1&t&&(e.TgZ(0,"div",22),e.TgZ(1,"div",23),e.TgZ(2,"span",24),e._uU(3),e.qZA(),e.qZA(),e.TgZ(4,"div",12),e.TgZ(5,"sub",25),e.ALo(6,"date"),e.TgZ(7,"i"),e._uU(8),e.ALo(9,"date"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"div",17),e.TgZ(11,"div",26),e._uU(12),e.qZA(),e.qZA()),2&t){const n=s.$implicit;e.xp6(3),e.Oqu(null==n?null:n.sourceAlias),e.xp6(2),e.s9C("matTooltip",e.xi3(6,4,null==n?null:n.date,"EEEE, MMMM d, y h:mm:ss a")),e.xp6(3),e.Oqu(e.xi3(9,7,null==n?null:n.date,"MMM d, y")),e.xp6(4),e.hij(" ",null==n?null:n.message," ")}}function N(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",23),e.TgZ(1,"div",17),e.TgZ(2,"div",12),e.TgZ(3,"mat-form-field",27),e.TgZ(4,"textarea",28,29),e.NdJ("keydown.enter",function(o){return o.preventDefault()})("keyup.enter",function(){e.CHM(n);const o=e.MAs(5);return e.oxw().sendMessage(o)}),e.qZA(),e.TgZ(7,"mat-icon",30),e._uU(8,"sentiment_very_satisfied"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&t){const n=e.oxw();e.xp6(4),e.Q6J("placeholder","Message "+(null==n.targetUser?null:n.targetUser.alias))}}const E=[{path:"",component:m,children:[{path:"",redirectTo:"private",pathMatch:"full"},{path:"private",component:(()=>{class t{constructor(n,a){this.ogreService=n,this.messageService=a,this.targetUser=void 0,this.displayedMessages=[]}ngOnInit(){this.ogreService.onTargetUserUpdated().subscribe(n=>{this.targetUser=n,this.targetUser&&(this.displayedMessages=this.messageService.getMessagesById(this.targetUser.id),this.messagesSubscription&&this.messagesSubscription.unsubscribe(),this.messagesSubscription=this.messageService.onMessageById(this.targetUser.id).subscribe(a=>{this.displayedMessages.push(a),this.scrollMessageBoxDown()}))})}sendMessage(n){var a=this;return(0,u.Z)(function*(){const o=yield a.ogreService.getUser(),p={bare:!0,message:n.value,source:o.id,sourceAlias:o.alias,target:o.id,date:new Date};a.displayedMessages.push(p),a.scrollMessageBoxDown(),a.ogreService.sendMessage(n.value),n.value=""})()}scrollMessageBoxDown(){setTimeout(()=>{this.messageBoxElement.nativeElement.scrollTop=this.messageBoxElement.nativeElement.scrollHeight})}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(d.B),e.Y36(v.e))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-private"]],viewQuery:function(n,a){if(1&n&&e.Gf(Z,5),2&n){let o;e.iGM(o=e.CRH())&&(a.messageBoxElement=o.first)}},decls:11,vars:1,consts:[[4,"ngIf"],["selectedUserNavTemplate2",""],["selectedUserNavTemplate",""],["displayedMessagesTemplate",""],["displayedMessageTemplate",""],["inputTemplate",""],[1,"row","vh-100","flex-column"],[4,"ngTemplateOutlet"],[1,"bg-3","col-auto"],[1,"row","align-items-center","ps-3","pt-1"],[1,"col-auto","my-1"],["src","assets/logo/parfay.svg","width","20px",2,"filter","invert(1) contrast(0.5)","mix-blend-mode","difference"],[1,"col"],[1,"col-auto","bg-3"],[1,"row","align-items-center","mt-1"],[1,"col",2,"overflow","auto"],["messageBoxElement",""],[1,"row"],[1,"col","g-0"],["class","py-2 px-3 hover-highlight",4,"ngFor","ngForOf"],[1,"py-2","px-3","hover-highlight"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"g-2","mb-1","row","align-items-end"],[1,"col-auto"],[2,"font-weight","500"],[3,"matTooltip"],[1,"col",2,"white-space","pre-line"],["appearance","fill",1,"w-100"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","1",3,"placeholder","keydown.enter","keyup.enter"],["messageBox","","autosize","cdkTextareaAutosize"],["matSuffix",""]],template:function(n,a){1&n&&(e.YNc(0,y,5,3,"ng-container",0),e.YNc(1,A,6,1,"ng-template",null,1,e.W1O),e.YNc(3,U,6,1,"ng-template",null,2,e.W1O),e.YNc(5,q,5,1,"ng-template",null,3,e.W1O),e.YNc(7,B,13,10,"ng-template",null,4,e.W1O),e.YNc(9,N,9,1,"ng-template",null,5,e.W1O)),2&n&&e.Q6J("ngIf",a.targetUser)},directives:[l.O5,l.tP,l.sg,f.gM,g.KE,h.Nt,T.IC,x.Hw,g.R9],pipes:[l.uU],styles:[""]}),t})()}]}];let S=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[r.Bz.forChild(E)],r.Bz]}),t})();var Y=i(4466),F=i(7078);let J=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[l.ez,S,Y.m,F.q]]}),t})()}}]);